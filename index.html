<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <style>
        .container {
            margin:auto;
        }
        .todoitem {
            color: blue;
        }
        .todoitemdone {
            color: green;
        }


    </style>
    <div class="container">
        <form class="toDoForm" action="">
            <h1>To Do list</h1>
            <input class="inputToDo" type="text" value="" placeholder="add an item...">
            <input class="submitBtn" type="submit" value="Send">
        </form>

        <div class="formOutput">
        </div>
    </div>  


    <script>
        function createItem(text){
            const newTodoItem = `
            <li class='todoitem'>${text}
            <button class='deleteTask'>X</button>
            <button class='doneBtn'>Done</button>
            </li>
            `            
            const newFragment = document.createRange().createContextualFragment(newTodoItem)
            return newFragment;
             
             
        }     

        const inputBox = document.querySelector(".inputToDo"); 
        const toDoForm = document.querySelector(".toDoForm");
        const itemsList = document.querySelector('.formOutput');    

        
        function createNewItems(newItem){

            let ul = document.querySelector('.formOutput ul');
            const listItem = createItem(newItem);

            if(ul){
                ul.appendChild(listItem);
            } else {
                ul = document.createElement('ul');
                ul.appendChild(listItem)
            }
            itemsList.appendChild(ul);
        }
          
        
        //-----Original handle function to start the flow upon submit-----
        function handleSubmit(e) {
            e.preventDefault(); //stop page from refreshing
            const txtInput = inputBox.value; // save input txt
            toDoForm.reset(); //clear input box
            txtInput === "" ? console.log('no input') : createNewItems(txtInput);
        }        
        toDoForm.addEventListener("submit", handleSubmit);




        //done button functionality
        function finishItem(e){  
                if (e.target.classList == 'doneBtn') {
                const doneButton = e.target;
                const currentItem = doneButton.parentNode;
                currentItem.classList.replace(`${currentItem.classList}`,'todoitemdone')
            } else if (e.target.classList == 'deleteTask'){
                const xButton = e.target;
                xButton.parentNode.remove(null)
            } 
        }

        itemsList.addEventListener("click",finishItem)

        // to do list for the profect:
        
        // ---implement functional programming concept of single purpose functions

        // ---refactor with arrow functions

        // ---add minimal css for project to seem somewhat presentable

        // ---
        
        //fix countinuous creation of ul


        //add clear list button
    
        
        //refactor with XSS proof

    </script>
</body>
</html>


